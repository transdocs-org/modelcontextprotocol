---
title: Ping
weight: 5
---

<Info>**协议版本**：2024-11-05</Info>

Model Context 协议包含一个可选的 ping 机制，该机制允许通信任一方验证对方是否仍然响应正常，以及连接是否处于活跃状态。

## 概述

Ping 功能通过一个简单的请求/响应模式实现。客户端或服务端都可以通过发送 `ping` 请求来发起 ping 操作。

## 消息格式

一个 ping 请求是一个没有参数的标准 JSON-RPC 请求：

```json
{
  "jsonrpc": "2.0",
  "id": "123",
  "method": "ping"
}
```

## 行为要求

1. 接收方 **必须** 立即响应一个空响应：

```json
{
  "jsonrpc": "2.0",
  "id": "123",
  "result": {}
}
```

2. 如果在合理的超时时间内未收到响应，发送方 **可以**：
   - 认为连接已失效
   - 终止连接
   - 尝试重新连接流程

## 使用模式

```mermaid
sequenceDiagram
    participant Sender
    participant Receiver

    Sender->>Receiver: ping 请求
    Receiver->>Sender: 空响应
```

## 实现考虑

- 实现 **应该** 周期性地发送 ping 请求以检测连接状态
- ping 的频率 **应该** 可配置
- 超时时间 **应该** 根据网络环境合理设置
- 应 **避免** 过度发送 ping 请求以减少网络开销

## 错误处理

- 超时 **应该** 被视为连接失败
- 多次 ping 失败 **可以** 触发连接重置
- 实现 **应该** 记录 ping 失败日志以用于诊断